// RUN: hlo_to_llvm_ir --ptx --sm=50 %s | FileCheck %s

// CHECK-NOT: ld.global.nc.v2.f32
// CHECK: ld.global.nc.f32
// CHECK: ld.global.nc.f32
// CHECK: ld.global.nc.f32
// CHECK: ld.global.nc.f32
// CHECK: ld.global.nc.f32
// CHECK: ld.global.nc.f32
// CHECK: ld.global.nc.f32
// CHECK: ld.global.nc.f32

HloModule DisableSin

%add_float {
  %x = f32[] parameter(0)
  %y = f32[] parameter(1)
  ROOT %add.17 = f32[] add(f32[] %x, f32[] %y)
}

ENTRY %main {
  %arg0.1 = f32[5,131072] parameter(0)
  %sine = f32[5,131072] exponential(f32[5,131072] %arg0.1)
  %constant.0 = f32[] constant(0)
  ROOT %reduce.18 = f32[5] reduce(f32[5,131072] %sine, f32[] %constant.0), dimensions={1}, to_apply=%add_float
}
